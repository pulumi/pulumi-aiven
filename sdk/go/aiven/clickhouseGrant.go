// Code generated by pulumi-language-go DO NOT EDIT.
// *** WARNING: Do not edit by hand unless you're certain you know what you are doing! ***

package aiven

import (
	"context"
	"reflect"

	"errors"
	"github.com/pulumi/pulumi-aiven/sdk/v6/go/aiven/internal"
	"github.com/pulumi/pulumi/sdk/v3/go/pulumi"
)

// Creates and manages ClickHouse grants to give users and roles privileges to a ClickHouse service.
//
// There are some limitations and considerations to be aware of when using this resource:
//   - Users cannot have the same name as roles.
//   - Global privileges cannot be granted on the database level. To grant global privileges, use `database="*"`.
//   - To grant a privilege on all tables of a database, omit the table and only keep the database. Don't use `table="*"`.
//   - Privileges granted on ClickHouse Named Collections are not currently managed by this resource and will be ignored. If you have grants on Named Collections managed outside of Terraform, this resource will not attempt to alter them. For an example showing how to set up Named Collection access with S3 integration, see the ClickHouse S3 Integration example.
//   - Changes first revoke all grants and then reissue the remaining grants for convergence.
//   - Some grants overlap, which can cause the Aiven Terraform Provider to detect a change even if you haven't made modifications. For example, using both `DELETE` and `ALTER DELETE` together might cause this issue.
//     The [ClickHouse grant privileges documentation](https://clickhouse.com/docs/sql-reference/statements/grant) has a list of ClickHouse privileges.
//
// ## Example Usage
//
// ```go
// package main
//
// import (
//
//	"github.com/pulumi/pulumi-aiven/sdk/v6/go/aiven"
//	"github.com/pulumi/pulumi/sdk/v3/go/pulumi"
//
// )
//
//	func main() {
//		pulumi.Run(func(ctx *pulumi.Context) error {
//			exampleRole, err := aiven.NewClickhouseRole(ctx, "example_role", &aiven.ClickhouseRoleArgs{
//				Project:     pulumi.Any(exampleProject.Project),
//				ServiceName: pulumi.Any(exampleClickhouse.ServiceName),
//				Role:        pulumi.String("example-role"),
//			})
//			if err != nil {
//				return err
//			}
//			// Grant privileges to the example role.
//			_, err = aiven.NewClickhouseGrant(ctx, "role_privileges", &aiven.ClickhouseGrantArgs{
//				Project:     pulumi.Any(exampleProject.Project),
//				ServiceName: pulumi.Any(exampleClickhouse.ServiceName),
//				Role:        exampleRole.Role,
//				PrivilegeGrants: aiven.ClickhouseGrantPrivilegeGrantArray{
//					&aiven.ClickhouseGrantPrivilegeGrantArgs{
//						Privilege: pulumi.String("INSERT"),
//						Database:  pulumi.Any(exampleDb.Name),
//						Table:     pulumi.String("example-table"),
//					},
//					&aiven.ClickhouseGrantPrivilegeGrantArgs{
//						Privilege: pulumi.String("SELECT"),
//						Database:  pulumi.Any(exampleDb.Name),
//					},
//					&aiven.ClickhouseGrantPrivilegeGrantArgs{
//						Privilege: pulumi.String("CREATE TEMPORARY TABLE"),
//						Database:  pulumi.String("*"),
//					},
//					&aiven.ClickhouseGrantPrivilegeGrantArgs{
//						Privilege: pulumi.String("SYSTEM DROP CACHE"),
//						Database:  pulumi.String("*"),
//					},
//				},
//			})
//			if err != nil {
//				return err
//			}
//			// Grant the role to the user.
//			exampleUser, err := aiven.NewClickhouseUser(ctx, "example_user", &aiven.ClickhouseUserArgs{
//				Project:     pulumi.Any(exampleProject.Project),
//				ServiceName: pulumi.Any(exampleClickhouse.ServiceName),
//				Username:    pulumi.String("example-user"),
//			})
//			if err != nil {
//				return err
//			}
//			_, err = aiven.NewClickhouseGrant(ctx, "user_role_assignment", &aiven.ClickhouseGrantArgs{
//				Project:     pulumi.Any(exampleProject.Project),
//				ServiceName: pulumi.Any(exampleClickhouse.ServiceName),
//				User:        exampleUser.Username,
//				RoleGrants: aiven.ClickhouseGrantRoleGrantArray{
//					&aiven.ClickhouseGrantRoleGrantArgs{
//						Role: exampleRole.Role,
//					},
//				},
//			})
//			if err != nil {
//				return err
//			}
//			return nil
//		})
//	}
//
// ```
//
// ## Import
//
// ```sh
// $ pulumi import aiven:index/clickhouseGrant:ClickhouseGrant example_grant PROJECT/SERVICE_NAME/ID
// ```
type ClickhouseGrant struct {
	pulumi.CustomResourceState

	// Grant privileges. Changing this property forces recreation of the resource.
	PrivilegeGrants ClickhouseGrantPrivilegeGrantArrayOutput `pulumi:"privilegeGrants"`
	// The name of the project this resource belongs to. To set up proper dependencies please refer to this variable as a reference. Changing this property forces recreation of the resource.
	Project pulumi.StringOutput `pulumi:"project"`
	// The role to grant privileges or roles to. To set up proper dependencies please refer to this variable as a reference. Changing this property forces recreation of the resource.
	Role pulumi.StringPtrOutput `pulumi:"role"`
	// Grant roles. Changing this property forces recreation of the resource.
	RoleGrants ClickhouseGrantRoleGrantArrayOutput `pulumi:"roleGrants"`
	// The name of the service that this resource belongs to. To set up proper dependencies please refer to this variable as a reference. Changing this property forces recreation of the resource.
	ServiceName pulumi.StringOutput `pulumi:"serviceName"`
	// The user to grant privileges or roles to. To set up proper dependencies please refer to this variable as a reference. Changing this property forces recreation of the resource.
	User pulumi.StringPtrOutput `pulumi:"user"`
}

// NewClickhouseGrant registers a new resource with the given unique name, arguments, and options.
func NewClickhouseGrant(ctx *pulumi.Context,
	name string, args *ClickhouseGrantArgs, opts ...pulumi.ResourceOption) (*ClickhouseGrant, error) {
	if args == nil {
		return nil, errors.New("missing one or more required arguments")
	}

	if args.Project == nil {
		return nil, errors.New("invalid value for required argument 'Project'")
	}
	if args.ServiceName == nil {
		return nil, errors.New("invalid value for required argument 'ServiceName'")
	}
	opts = internal.PkgResourceDefaultOpts(opts)
	var resource ClickhouseGrant
	err := ctx.RegisterResource("aiven:index/clickhouseGrant:ClickhouseGrant", name, args, &resource, opts...)
	if err != nil {
		return nil, err
	}
	return &resource, nil
}

// GetClickhouseGrant gets an existing ClickhouseGrant resource's state with the given name, ID, and optional
// state properties that are used to uniquely qualify the lookup (nil if not required).
func GetClickhouseGrant(ctx *pulumi.Context,
	name string, id pulumi.IDInput, state *ClickhouseGrantState, opts ...pulumi.ResourceOption) (*ClickhouseGrant, error) {
	var resource ClickhouseGrant
	err := ctx.ReadResource("aiven:index/clickhouseGrant:ClickhouseGrant", name, id, state, &resource, opts...)
	if err != nil {
		return nil, err
	}
	return &resource, nil
}

// Input properties used for looking up and filtering ClickhouseGrant resources.
type clickhouseGrantState struct {
	// Grant privileges. Changing this property forces recreation of the resource.
	PrivilegeGrants []ClickhouseGrantPrivilegeGrant `pulumi:"privilegeGrants"`
	// The name of the project this resource belongs to. To set up proper dependencies please refer to this variable as a reference. Changing this property forces recreation of the resource.
	Project *string `pulumi:"project"`
	// The role to grant privileges or roles to. To set up proper dependencies please refer to this variable as a reference. Changing this property forces recreation of the resource.
	Role *string `pulumi:"role"`
	// Grant roles. Changing this property forces recreation of the resource.
	RoleGrants []ClickhouseGrantRoleGrant `pulumi:"roleGrants"`
	// The name of the service that this resource belongs to. To set up proper dependencies please refer to this variable as a reference. Changing this property forces recreation of the resource.
	ServiceName *string `pulumi:"serviceName"`
	// The user to grant privileges or roles to. To set up proper dependencies please refer to this variable as a reference. Changing this property forces recreation of the resource.
	User *string `pulumi:"user"`
}

type ClickhouseGrantState struct {
	// Grant privileges. Changing this property forces recreation of the resource.
	PrivilegeGrants ClickhouseGrantPrivilegeGrantArrayInput
	// The name of the project this resource belongs to. To set up proper dependencies please refer to this variable as a reference. Changing this property forces recreation of the resource.
	Project pulumi.StringPtrInput
	// The role to grant privileges or roles to. To set up proper dependencies please refer to this variable as a reference. Changing this property forces recreation of the resource.
	Role pulumi.StringPtrInput
	// Grant roles. Changing this property forces recreation of the resource.
	RoleGrants ClickhouseGrantRoleGrantArrayInput
	// The name of the service that this resource belongs to. To set up proper dependencies please refer to this variable as a reference. Changing this property forces recreation of the resource.
	ServiceName pulumi.StringPtrInput
	// The user to grant privileges or roles to. To set up proper dependencies please refer to this variable as a reference. Changing this property forces recreation of the resource.
	User pulumi.StringPtrInput
}

func (ClickhouseGrantState) ElementType() reflect.Type {
	return reflect.TypeOf((*clickhouseGrantState)(nil)).Elem()
}

type clickhouseGrantArgs struct {
	// Grant privileges. Changing this property forces recreation of the resource.
	PrivilegeGrants []ClickhouseGrantPrivilegeGrant `pulumi:"privilegeGrants"`
	// The name of the project this resource belongs to. To set up proper dependencies please refer to this variable as a reference. Changing this property forces recreation of the resource.
	Project string `pulumi:"project"`
	// The role to grant privileges or roles to. To set up proper dependencies please refer to this variable as a reference. Changing this property forces recreation of the resource.
	Role *string `pulumi:"role"`
	// Grant roles. Changing this property forces recreation of the resource.
	RoleGrants []ClickhouseGrantRoleGrant `pulumi:"roleGrants"`
	// The name of the service that this resource belongs to. To set up proper dependencies please refer to this variable as a reference. Changing this property forces recreation of the resource.
	ServiceName string `pulumi:"serviceName"`
	// The user to grant privileges or roles to. To set up proper dependencies please refer to this variable as a reference. Changing this property forces recreation of the resource.
	User *string `pulumi:"user"`
}

// The set of arguments for constructing a ClickhouseGrant resource.
type ClickhouseGrantArgs struct {
	// Grant privileges. Changing this property forces recreation of the resource.
	PrivilegeGrants ClickhouseGrantPrivilegeGrantArrayInput
	// The name of the project this resource belongs to. To set up proper dependencies please refer to this variable as a reference. Changing this property forces recreation of the resource.
	Project pulumi.StringInput
	// The role to grant privileges or roles to. To set up proper dependencies please refer to this variable as a reference. Changing this property forces recreation of the resource.
	Role pulumi.StringPtrInput
	// Grant roles. Changing this property forces recreation of the resource.
	RoleGrants ClickhouseGrantRoleGrantArrayInput
	// The name of the service that this resource belongs to. To set up proper dependencies please refer to this variable as a reference. Changing this property forces recreation of the resource.
	ServiceName pulumi.StringInput
	// The user to grant privileges or roles to. To set up proper dependencies please refer to this variable as a reference. Changing this property forces recreation of the resource.
	User pulumi.StringPtrInput
}

func (ClickhouseGrantArgs) ElementType() reflect.Type {
	return reflect.TypeOf((*clickhouseGrantArgs)(nil)).Elem()
}

type ClickhouseGrantInput interface {
	pulumi.Input

	ToClickhouseGrantOutput() ClickhouseGrantOutput
	ToClickhouseGrantOutputWithContext(ctx context.Context) ClickhouseGrantOutput
}

func (*ClickhouseGrant) ElementType() reflect.Type {
	return reflect.TypeOf((**ClickhouseGrant)(nil)).Elem()
}

func (i *ClickhouseGrant) ToClickhouseGrantOutput() ClickhouseGrantOutput {
	return i.ToClickhouseGrantOutputWithContext(context.Background())
}

func (i *ClickhouseGrant) ToClickhouseGrantOutputWithContext(ctx context.Context) ClickhouseGrantOutput {
	return pulumi.ToOutputWithContext(ctx, i).(ClickhouseGrantOutput)
}

// ClickhouseGrantArrayInput is an input type that accepts ClickhouseGrantArray and ClickhouseGrantArrayOutput values.
// You can construct a concrete instance of `ClickhouseGrantArrayInput` via:
//
//	ClickhouseGrantArray{ ClickhouseGrantArgs{...} }
type ClickhouseGrantArrayInput interface {
	pulumi.Input

	ToClickhouseGrantArrayOutput() ClickhouseGrantArrayOutput
	ToClickhouseGrantArrayOutputWithContext(context.Context) ClickhouseGrantArrayOutput
}

type ClickhouseGrantArray []ClickhouseGrantInput

func (ClickhouseGrantArray) ElementType() reflect.Type {
	return reflect.TypeOf((*[]*ClickhouseGrant)(nil)).Elem()
}

func (i ClickhouseGrantArray) ToClickhouseGrantArrayOutput() ClickhouseGrantArrayOutput {
	return i.ToClickhouseGrantArrayOutputWithContext(context.Background())
}

func (i ClickhouseGrantArray) ToClickhouseGrantArrayOutputWithContext(ctx context.Context) ClickhouseGrantArrayOutput {
	return pulumi.ToOutputWithContext(ctx, i).(ClickhouseGrantArrayOutput)
}

// ClickhouseGrantMapInput is an input type that accepts ClickhouseGrantMap and ClickhouseGrantMapOutput values.
// You can construct a concrete instance of `ClickhouseGrantMapInput` via:
//
//	ClickhouseGrantMap{ "key": ClickhouseGrantArgs{...} }
type ClickhouseGrantMapInput interface {
	pulumi.Input

	ToClickhouseGrantMapOutput() ClickhouseGrantMapOutput
	ToClickhouseGrantMapOutputWithContext(context.Context) ClickhouseGrantMapOutput
}

type ClickhouseGrantMap map[string]ClickhouseGrantInput

func (ClickhouseGrantMap) ElementType() reflect.Type {
	return reflect.TypeOf((*map[string]*ClickhouseGrant)(nil)).Elem()
}

func (i ClickhouseGrantMap) ToClickhouseGrantMapOutput() ClickhouseGrantMapOutput {
	return i.ToClickhouseGrantMapOutputWithContext(context.Background())
}

func (i ClickhouseGrantMap) ToClickhouseGrantMapOutputWithContext(ctx context.Context) ClickhouseGrantMapOutput {
	return pulumi.ToOutputWithContext(ctx, i).(ClickhouseGrantMapOutput)
}

type ClickhouseGrantOutput struct{ *pulumi.OutputState }

func (ClickhouseGrantOutput) ElementType() reflect.Type {
	return reflect.TypeOf((**ClickhouseGrant)(nil)).Elem()
}

func (o ClickhouseGrantOutput) ToClickhouseGrantOutput() ClickhouseGrantOutput {
	return o
}

func (o ClickhouseGrantOutput) ToClickhouseGrantOutputWithContext(ctx context.Context) ClickhouseGrantOutput {
	return o
}

// Grant privileges. Changing this property forces recreation of the resource.
func (o ClickhouseGrantOutput) PrivilegeGrants() ClickhouseGrantPrivilegeGrantArrayOutput {
	return o.ApplyT(func(v *ClickhouseGrant) ClickhouseGrantPrivilegeGrantArrayOutput { return v.PrivilegeGrants }).(ClickhouseGrantPrivilegeGrantArrayOutput)
}

// The name of the project this resource belongs to. To set up proper dependencies please refer to this variable as a reference. Changing this property forces recreation of the resource.
func (o ClickhouseGrantOutput) Project() pulumi.StringOutput {
	return o.ApplyT(func(v *ClickhouseGrant) pulumi.StringOutput { return v.Project }).(pulumi.StringOutput)
}

// The role to grant privileges or roles to. To set up proper dependencies please refer to this variable as a reference. Changing this property forces recreation of the resource.
func (o ClickhouseGrantOutput) Role() pulumi.StringPtrOutput {
	return o.ApplyT(func(v *ClickhouseGrant) pulumi.StringPtrOutput { return v.Role }).(pulumi.StringPtrOutput)
}

// Grant roles. Changing this property forces recreation of the resource.
func (o ClickhouseGrantOutput) RoleGrants() ClickhouseGrantRoleGrantArrayOutput {
	return o.ApplyT(func(v *ClickhouseGrant) ClickhouseGrantRoleGrantArrayOutput { return v.RoleGrants }).(ClickhouseGrantRoleGrantArrayOutput)
}

// The name of the service that this resource belongs to. To set up proper dependencies please refer to this variable as a reference. Changing this property forces recreation of the resource.
func (o ClickhouseGrantOutput) ServiceName() pulumi.StringOutput {
	return o.ApplyT(func(v *ClickhouseGrant) pulumi.StringOutput { return v.ServiceName }).(pulumi.StringOutput)
}

// The user to grant privileges or roles to. To set up proper dependencies please refer to this variable as a reference. Changing this property forces recreation of the resource.
func (o ClickhouseGrantOutput) User() pulumi.StringPtrOutput {
	return o.ApplyT(func(v *ClickhouseGrant) pulumi.StringPtrOutput { return v.User }).(pulumi.StringPtrOutput)
}

type ClickhouseGrantArrayOutput struct{ *pulumi.OutputState }

func (ClickhouseGrantArrayOutput) ElementType() reflect.Type {
	return reflect.TypeOf((*[]*ClickhouseGrant)(nil)).Elem()
}

func (o ClickhouseGrantArrayOutput) ToClickhouseGrantArrayOutput() ClickhouseGrantArrayOutput {
	return o
}

func (o ClickhouseGrantArrayOutput) ToClickhouseGrantArrayOutputWithContext(ctx context.Context) ClickhouseGrantArrayOutput {
	return o
}

func (o ClickhouseGrantArrayOutput) Index(i pulumi.IntInput) ClickhouseGrantOutput {
	return pulumi.All(o, i).ApplyT(func(vs []interface{}) *ClickhouseGrant {
		return vs[0].([]*ClickhouseGrant)[vs[1].(int)]
	}).(ClickhouseGrantOutput)
}

type ClickhouseGrantMapOutput struct{ *pulumi.OutputState }

func (ClickhouseGrantMapOutput) ElementType() reflect.Type {
	return reflect.TypeOf((*map[string]*ClickhouseGrant)(nil)).Elem()
}

func (o ClickhouseGrantMapOutput) ToClickhouseGrantMapOutput() ClickhouseGrantMapOutput {
	return o
}

func (o ClickhouseGrantMapOutput) ToClickhouseGrantMapOutputWithContext(ctx context.Context) ClickhouseGrantMapOutput {
	return o
}

func (o ClickhouseGrantMapOutput) MapIndex(k pulumi.StringInput) ClickhouseGrantOutput {
	return pulumi.All(o, k).ApplyT(func(vs []interface{}) *ClickhouseGrant {
		return vs[0].(map[string]*ClickhouseGrant)[vs[1].(string)]
	}).(ClickhouseGrantOutput)
}

func init() {
	pulumi.RegisterInputType(reflect.TypeOf((*ClickhouseGrantInput)(nil)).Elem(), &ClickhouseGrant{})
	pulumi.RegisterInputType(reflect.TypeOf((*ClickhouseGrantArrayInput)(nil)).Elem(), ClickhouseGrantArray{})
	pulumi.RegisterInputType(reflect.TypeOf((*ClickhouseGrantMapInput)(nil)).Elem(), ClickhouseGrantMap{})
	pulumi.RegisterOutputType(ClickhouseGrantOutput{})
	pulumi.RegisterOutputType(ClickhouseGrantArrayOutput{})
	pulumi.RegisterOutputType(ClickhouseGrantMapOutput{})
}
